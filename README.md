# miR-RF Human pre-miRNA Explorer
[![License: CC BY 4.0](https://img.shields.io/badge/License-CC%20BY%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by/4.0/)

# miR-RF Human pre-miRNA Explorer

An interactive **Streamlit** web application for exploring, filtering, and exporting human pre-miRNA annotations generated by the **miR-RF** workflow, as described in:

> *"An operational workflow for the systematic annotation of human miRNAs"*

This application enables dynamic interrogation and subsetting of human pre-miRNAs based on:

- **Predicted structural stability**
- **Evolutionary conservation**
- **Tissue expression patterns**

Users can define flexible, multi-parameter filtering strategies tailored to specific biological questions, and export selected subsets for downstream analyses.
The app is designed to support both exploratory data analysis and hypothesis-driven investigation of human pre-miRNA candidates, along with their sequence.


ğŸ”— **Live app:**
[https://app-mir-rf-vfd7s8nncj3mx6anbaaxrh.streamlit.app/](https://app-mir-rf-vfd7s8nncj3mx6anbaaxrh.streamlit.app/)

---


## ğŸ“Š Overview

Human pre-miRNAs are displayed in an interactive table featuring:

- **Sticky header** and **sticky first column** for improved navigation
- **Color-coded cells** with an integrated legend indicating:
  - Pass/fail status for **structure**, **conservation**, and **expression**
  - **miRNA family membership**
  - **Human (hsa) specificity**
  - **Repeat element presence**
  - **Species-level structural stability** and â€œnot foundâ€ status
  - **Tissue expression threshold** (RPMM â‰¥ 1.5 vs < 1.5)
  - **miRBase / MirGeneDB structural classes** (R/D/I/S), when enabled

---

### ğŸ” Integrated Annotation 

The browser combines annotations described in

> *"An operational workflow for the systematic annotation of human miRNAs"*:

- **miR-RF structural stability classes** (R/D/I/S)
- **Multi-species conservation profiles**, including human specificity
- **Tissue expression values** (RPMM)
- **miRNA family context** (miRBase / MirGeneDB)
- **Repeat annotation**

All displayed results correspond to the analyses reported in the accompanying manuscript and are provided as a reusable resource to support downstream computational and experimental studies.


## â„¹ï¸ About the Interface

This application is built using **Streamlit**, an interactive framework for data-driven web applications.

If you are unfamiliar with how Streamlit apps behave (e.g., automatic updates when filters change, sidebar controls, interactive widgets), we encourage you to consult the official documentation:

ğŸ‘‰ https://docs.streamlit.io/

In particular, the â€œMain Conceptsâ€ section provides a helpful overview of how Streamlit applications function.

---

## âœ¨ Key features

### Interactive filtering (sidebar)

Filters can be combined freely: **any combination of filters can be applied simultaneously**.

All selected filters are combined using **logical AND**.  
This means that only pre-miRNAs satisfying *all* active criteria will be displayed in the table.

Results update automatically whenever filter settings are modified.


### ğŸ” Search by name

  Search for one or more miRNAs across all rows of the table.
  - Matching is case-insensitive.
  - The search performs a partial match: rows are kept if any cell contains the input text.
  - Regular expressions (regex) are supported for advanced queries (e.g. ^hsa- to match entries starting with hsa-).


### ğŸ– Evolutionary Conservation

  Keep or exclude human pre-miRNAs based on their evolutionary conservation across selected species.
  - **Show all (default)**: no conservation-based filtering is applied.
  - **PASSED**: evolutionarily conserved according to the criteria defined in the manuscript (detected in â‰¥ 3 species).
  - **NOT PASSED**: not conserved under the specified criteria.


### ğŸ« Expression

  Keep or filter human pre-miRNAs evidence of expression.
  - **Show all (default)**: no filter applied.
  - **PASSED**: expressed according to the criteria defined in the paper (RPMM â‰¥ in at least one tissue).
  - **NOT PASSED**: not conserved under the specified criteria.


### ğŸ§¬ Structural Classification Filter (miRBase / MirGeneDB)

  Retain or exclude human pre-miRNAs based on their structural classification in **miRBase** or **MirGeneDB**.
  - **Show all (default)**: no structural filtering is applied.
  - **PASSED**: pre-miRNAs classified as **R** or **D** (structurally robust).
  - **NOT PASSED**: pre-miRNAs classified as **I** or **S** (structurally unstable or weakly supported).


### ğŸ§ğŸ¼â€â™€ï¸ Human specificic pre-miRNAs

  Filter human-specific or non human-specific pre-miRNAs.
  - **Show all (default)**: no filtering is applied.
  - **Only hsa-specific**: retain only pre-miRNAs annotated as human-specific.
  - **Not hsa-specific**: exclude human-specific premiRNAs and retain all other entries.



### ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ miRNA Family Membership


  Filter pre-miRNAs based on family annotations from **miRBase** and/or **MirGeneDB**.
  - **no family**: pre-miRNAs not assigned to any family in the selected databases.
  - **miRNAs in family**: pre-miRNAs annotated as belonging to a family (the family name is displayed when available).


###  ğŸ§® Repeat class

  Filter miRNAs based on the presence and type of overlapping repeat elements.
  - Select one or more repeat classes (e.g., LINE, SINE, LTR, DNA transposons, low-complexity repeats).
  - If multiple classes are selected, miRNAs overlapping **any** of the chosen categories are retained (logical OR).


### ğŸ“ˆ Show repeat class distribution

  Enable **â€œShow repeat class distributionâ€** to visualize the repeat composition of the currently filtered subset.
  - The bar plot displays both **counts** and **percentages** for each repeat class.
  - This visualization helps assess whether applied filters enrich for specific repeat categories.
    
---

## âš™ï¸ Advanced options

Enable Advanced options in the sidebar to unlock additional controls and column display options.

### ğŸ‚ Evolutionary conservation (advanced)

  - Show species columns: display per-species conservation.
  - Filter by:
    - **Found in** selected species
    - **Not found in** selected species
  - Optional: stratify by structural stability when **Found in** is active: **Stable (R/D)** vs **Unstable (S/I)**


### ğŸ¦´ Tissue expression (advanced)

  - Show tissue columns by anatomical system (with icons)
  - Filter by:
    - **Expressed in**: selected tissues with RPMM â‰¥ 1.5 (all selected must pass)
    - **Not expressed in**: selected tissues with RPMM < 1.5 (all selected must pass)


### ğŸ—‚ï¸ Database / class (advanced)

  - Show Class columns (miRBase / MirGeneDB)
  - Database filter:
    - Entries present in both databases
    - Entries only in miRBase
  - Class filter:
    - Filter by structural class (R, D, I, S)

---

## â™»ï¸ Reset all filters

  - Use Reset all filters to clear selections and restore default settings.
  - The button appears only when at least one filter is active
  - It also resets navigation-dependent state (e.g. pagination)

---

## â¬‡ï¸ Data export

The currently filtered dataset can be exported as:
* **TSV table** (only visible columns; clean formatting)
* **FASTA file** for the filtered subset (from the `sequence` column)

These exports are intended to support downstream analyses and custom pipelines.

---

## Repository contents

* `app.py` â€“ Streamlit application code
* `sfile2_NEW_plusFam.csv` â€“ curated dataset used by the app
* `*.png` â€“ anatomical system icons used in the interface
* `README.md` â€“ documentation

---

## ğŸªª License
This work is licensed under a Creative Commons Attribution 4.0 International License (CC BY 4.0).

You are free to:

Share â€” copy and redistribute the material in any medium or format
Adapt â€” remix, transform, and build upon the material for any purpose, even commercially
Under the following terms:

Attribution â€” appropriate credit must be given to the original authors and the accompanying manuscript.
For details, see: https://creativecommons.org/licenses/by/4.0/

---

## ğŸ˜Š Citation

If you use this resource, please cite the accompanying manuscript:
> Canevotti et al., *"An operational workflow for the systematic annotation of human miRNAs"*, 
Manuscript under peer review.

---

## ğŸ§· Notes

* The application is intended as a **companion resource** to the manuscript and reflects the same thresholds and classification criteria.
* Users are encouraged to apply filtering strategies appropriate to their research goals (e.g., prioritizing structural robustness for functional studies vs. relaxing constraints for exploratory expression surveys).

---

## Example use cases

**Using the pre-miRNA Annotation Browser as a support tool**, the application can be used to narrow the search space by combining a set of complementary filters. 

### ğŸ«€ğŸ Use case 1 - Cardiovascular-associated miRNAs conserved in mouse

This use case identifies on human pre-miRNAs conserved in *Mus musculus*, structurally robust, and expressed in cardiovascular-related tissues or fluids.

**Conservation support**
- In **Advanced options â†’ Evolutionary conservation**, select *M. musculus* under **Found in**.
  This restricts the table to pre-miRNAs with detectable conservation in mouse.
- In **Advanced options â†’ Evolutionary conservation**, select *STABLE (R/D)* under **Structure**.

**Tissue expression context**
- In **Advanced options â†’ Tissue expression**, select tissues belonging to the **Cardiorespiratory system** (e.g. artery, heart, ventricle, vein, circulating compartments), under "Expressed in (select tissues by system):"
  This highlights loci expressed in cardiovascular-relevant contexts.

Under these conditions, 99 miRNAs are retained. For each entry, the app enables inspection of whether the locus:
- is conserved in mouse;
- displays expression across multiple cardiovascular tissues;
- is classified as structurally stable (R or D).

---

### ğŸ§ ğŸ¦§ Use case 2 - miRNAs conserved in Great apes (human and Pan) and expressed in brain

This use case identifies human pre-miRNAs that are conserved in *Pan troglodytes* and *Pan paniscus* and show expression in neural tissues.

**Conservation support**
- In **Advanced options â†’ Evolutionary conservation**, select *P. troglodytes* and *P. paniscus* under **Found in**.
- In **Advanced options â†’ Evolutionary conservation**, select *STABLE (R/D)* under **Structure**.
- In **Advanced options â†’ Evolutionary conservation**, select *M. mulatta* and *L. catta* under **Not found in**.  

**Tissue expression context**
- In **Advanced options â†’ Tissue expression**, select tissues belonging to the **Neuro-Endocrine system** (e.g. brain, cortex, cerebellum, hippocampus, neuron-related samples), under "Show tissue columns (by system):"
  This option displays the corresponding tissue expression columns but does not filter the results.

Under these conditions, 29 miRNAs are retained in the filtered table. For each entry, the app enables inspection of whether the locus:
- is conserved in *Pan troglodytes* and *Pan paniscus*
- not conserved in *Macaca mulatta* and *Lemur catta*
- is classified as structurally stable (R or D)
- displays expression across multiple neuro-endocrine tissues
